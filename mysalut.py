import telebot
import os
import random
from threading import Thread
from flask import Flask

# --- –°–ï–†–í–ï–†–ù–ê–Ø –ß–ê–°–¢–¨ –î–õ–Ø RENDER (–ë–ï–°–ü–õ–ê–¢–ù–´–ô –¢–ê–†–ò–§) ---
app = Flask('')

@app.route('/')
def home():
    return "–ë–æ—Ç –ê–∫–∞–¥–µ–º–∏–∏ –ê—Ä–∫–∞–Ω—ã –∞–∫—Ç–∏–≤–µ–Ω!"

def run():
    app.run(host='0.0.0.0', port=8080)

def keep_alive():
    t = Thread(target=run)
    t.start()

# --- –ù–ê–°–¢–†–û–ô–ö–ê –ë–û–¢–ê ---
API_TOKEN = os.environ.get('BOT_TOKEN')
bot = telebot.TeleBot(API_TOKEN)

# –¢–≤–æ–π –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ–∂–µ–ª–∞–Ω–∏–π
WISHES = [
    "–í –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–æ–π —á–∞—Å–æ–≤ —É—Ö–æ–¥—è—â–µ–≥–æ –≥–æ–¥–∞ –∑–∞–∑–≤–µ–Ω–µ–ª, –∫–∞–∫ –∫–æ–ª–æ–∫–æ–ª—å—á–∏–∫, —Å–º–µ—Ö –î–æ–º–æ–≤—ë–Ω–∫–∞-–ü—Ä–æ–∫–∞–∑–Ω–∏–∫–∞. –û–Ω –ø–æ–æ–±–µ—â–∞–ª —Ü–µ–ª—ã–π –≥–æ–¥ –±—ã—Ç—å –≤–∞—à–∏–º —Å–æ—é–∑–Ω–∏–∫–æ–º...",
    "–í—ã –Ω–∞—à–ª–∏ –≤ —Å–≤–æ–µ–º –∫–∞—Ä–º–∞–Ω–µ –∑–æ–ª–æ—Ç—É—é –Ω–∏—Ç—å, –æ–±—Ä–æ–Ω–µ–Ω–Ω—É—é —Å–∞–º–æ–π –°—É–¥—å–±–æ–π. –û–Ω–∞ —Å–≤—è–∂–µ—Ç –≤–∞—Å —Å –Ω—É–∂–Ω—ã–º–∏ –ª—é–¥—å–º–∏...",
    "–°—Ç—Ä–∞–Ω–Ω—ã–π —á–∞—Å–æ–≤—â–∏–∫ –ø–æ–¥–∞—Ä–∏–ª –≤–∞–º –∫–∞—Ä–º–∞–Ω–Ω—ã–µ —á–∞—Å—ã –±–µ–∑ —Å—Ç—Ä–µ–ª–æ–∫. –û–Ω–∏ ‚Äî –º–∞–≥–∏—á–µ—Å–∫–∏–π —Ç–∞–ª–∏—Å–º–∞–Ω...",
    "–°–µ–≥–æ–¥–Ω—è –∏–¥–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ",
    "–ü—Ç–∏—Ü–∞ —É—Ä–æ–Ω–∏–ª–∞ –≤–∞–º –Ω–∞ –ø–ª–µ—á–æ –≤–µ—Ç–æ—á–∫—É —Å–µ—Ä–µ–±—Ä–∏—Å—Ç–æ–π –æ–º–µ–ª—ã. –≠—Ç–æ –º–∞–≥–∏—á–µ—Å–∫–∏–π –º–∞–≥–Ω–∏—Ç –¥–ª—è –ª—é–±–≤–∏...",
    "–í—ã –Ω–∞—à–ª–∏ –≤ —Å–Ω–µ–≥—É –∫—Ä–æ—à–µ—á–Ω—ã–π —Å–µ—Ä–µ–±—Ä—è–Ω—ã–π –∫–æ–ª–æ–∫–æ–ª—å—á–∏–∫. –ï–≥–æ –∑–≤–æ–Ω –æ—Ç–≥–æ–Ω—è–µ—Ç –¥—É—Ä–Ω—ã–µ –º—ã—Å–ª–∏...",
    "–ò–∑ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω–æ–≥–æ –∫–∞–º–∏–Ω–∞ –∫ –≤–∞–º –Ω–∞ –ª–∞–¥–æ–Ω—å –ø—Ä—ã–≥–Ω—É–ª–∞ –∏—Å–∫—Ä–∞, –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∞—Å—å –≤ —è–Ω—Ç–∞—Ä–Ω—ã–π –∫–∞–º–µ–Ω—å. –í –≤–∞—à–µ–º –¥–æ–º–µ –±—É–¥–µ—Ç —É—é—Ç!",
    "–í —Å—Ç–∞—Ä–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –≤–∞–º –æ—Ç–∫—Ä—ã–ª–∞—Å—å —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–±—ã—Ç–æ–≥–æ –∞—Ç–ª–∞—Å–∞ –∑–≤–µ–∑–¥–Ω–æ–≥–æ –Ω–µ–±–∞. –°—É–¥—å–±–∞ –æ—Ç–º–µ—Ç–∏–ª–∞ –≤–∞—à—É –ª–∏—á–Ω—É—é –∑–≤–µ–∑–¥—É.",
    "–ù–∞ –≤–∞—à –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫ –æ–ø—É—Å—Ç–∏–ª–æ—Å—å –ø–µ—Ä–æ –°–∏–Ω–µ–π –ü—Ç–∏—Ü—ã. –í–µ—Å—å –≥–æ–¥ –æ–Ω–æ –±—É–¥–µ—Ç –ø—Ä–∏–Ω–æ—Å–∏—Ç—å –¥–æ–±—Ä—ã–µ –≤–µ—Å—Ç–∏.",
    "–í–∞–º –¥–æ—Å—Ç–∞–ª—Å—è —Å–æ—Å—É–¥, –Ω–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π —á–∏—Å—Ç—ã–º —Å–≤–µ—Ç–æ–º –ø–æ–ª–Ω–æ–π –ª—É–Ω—ã. –û–∫—Ä–æ–ø–∏—Ç–µ –∏–º —Å–≤–æ–∏ —Å–æ–º–Ω–µ–Ω–∏—è.",
    "–í—ã –Ω–∞—à–ª–∏ –±—Ä–æ—à—å –≤ –≤–∏–¥–µ —è–Ω—Ç–∞—Ä–Ω–æ–π —Å—Ç—Ä–µ–∫–æ–∑—ã. –í–∞—à–∏ —Å–º–µ–ª—ã–µ –∏–¥–µ–∏ –æ–±—Ä–µ—Ç—É—Ç –∫—Ä—ã–ª—å—è!",
    "–í–µ—Ç–µ—Ä –Ω–∞–ø–µ–ª –≤–∞–º –º–µ–ª–æ–¥–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Å—Ç–∞–Ω–µ—Ç –≤–∞—à–∏–º –º–∞–≥–∏—á–µ—Å–∫–∏–º —â–∏—Ç–æ–º.",
    "–í–∞–º –¥–æ—Å—Ç–∞–ª–∞—Å—å –Ω–µ–≤–∏–¥–∏–º–∞—è –∫–æ—Ä–∑–∏–Ω–∞ —Å –º–æ–ª–æ–¥–∏–ª—å–Ω—ã–º–∏ —è–±–ª–æ–∫–∞–º–∏. –û–Ω–∞ –ø—Ä–∏–±–∞–≤–∏—Ç —Å–∏–ª –∏ –∑–¥–æ—Ä–æ–≤—å—è.",
    "–í–∞–º –≤ —Ä—É–∫–∏ –ø–æ–ø–∞–ª –∫–ª—É–±–æ–∫ —Å–≤–µ—Ç—è—â–∏—Ö—Å—è –Ω–∏—Ç–µ–π. –û–Ω —É–∫–∞–∂–µ—Ç —Å–∞–º—ã–π –ª–µ–≥–∫–∏–π –ø—É—Ç—å –∫ —Ü–µ–ª–∏.",
    "–í—ã –Ω–∞—à–ª–∏ —Å—Ç–∞—Ä–∏–Ω–Ω—É—é —á–∞—à—É, –∫–æ—Ç–æ—Ä–∞—è –≤—Å–µ–≥–¥–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ–π. –í–∞—à–∏ —Ä–µ—Å—É—Ä—Å—ã –±—É–¥—É—Ç –≤–æ—Å–ø–æ–ª–Ω—è—Ç—å—Å—è —Å–∞–º–∏!",
    "–í—ã –ø–æ–π–º–∞–ª–∏ –ø–æ—Å–ª–µ–¥–Ω—é—é –∏—Å–∫—Ä—É —Å–∞–ª—é—Ç–∞. –û–Ω–∞ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∞—Å—å –≤ –ª–∏—á–Ω–æ–µ —Å–æ–ª–Ω—Ü–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –≥—Ä–µ—Ç—å –≤–∞—Å 365 –¥–Ω–µ–π!",
    "–í—ã —Å–ª—É—á–∞–π–Ω–æ –∑–∞–¥–µ–ª–∏ –∫–æ–ª–æ–∫–æ–ª—å—á–∏–∫, –∏ –Ω–∞ –≤–∞—Å –ø—Ä–æ—Å—ã–ø–∞–ª–∞—Å—å –∑–æ–ª–æ—Ç–∞—è –ø—ã–ª—å—Ü–∞. –í–∞—à–∏ —Å–ª–æ–≤–∞ —Ç–µ–ø–µ—Ä—å –æ–±–ª–∞–¥–∞—é—Ç –º–∞–≥–∏–µ–π.",
    "–í–µ—Ç–µ—Ä –ø—Ä–∏–Ω–µ—Å –≤–∞–º –∫–ª–æ—á–æ–∫ –±—É–º–∞–≥–∏ —Å –Ω–∞–¥–ø–∏—Å—å—é: ¬´–í—Å—ë –ø–æ–ª—É—á–∏–ª–æ—Å—å!¬ª. –≠—Ç–æ –∑–Ω–∞–∫ ‚Äî –¥–µ–π—Å—Ç–≤—É–π—Ç–µ —Å–º–µ–ª–æ!",
    "–°—Ä–µ–¥–∏ —Å—É–≥—Ä–æ–±–æ–≤ –≤—ã –Ω–∞—à–ª–∏ —Ü–≤–µ—Ç—É—â—É—é —Ñ–∏–∞–ª–∫—É. –í–∞—à–∞ –Ω–µ–∂–Ω–æ—Å—Ç—å —Å—Ç–∞–Ω–µ—Ç –≤–∞—à–µ–π —Å–∏–ª–æ–π.",
    "–í–∞–º –¥–æ—Å—Ç–∞–ª—Å—è –≥–ª–æ—Ç–æ–∫ –Ω–µ–≤–∏–¥–∏–º–æ–≥–æ —ç–ª–∏–∫—Å–∏—Ä–∞ –∏–∑ –∏—Å–∫—Ä –∫–æ—Å—Ç—Ä–∞. –û–Ω –≤—ã–∂–∂–µ—Ç –≤—Å–µ –≤–∞—à–∏ —Å—Ç—Ä–∞—Ö–∏.",
    "–í–∞–º –ø–æ–¥–∞—Ä–µ–Ω—ã –≤–æ–ª—à–µ–±–Ω—ã–µ –æ—á–∫–∏, –æ—Ç—Ä–∞–∂–∞—é—â–∏–µ –Ω–µ–≥–∞—Ç–∏–≤. –í—ã –±—É–¥–µ—Ç–µ –≤–∏–¥–µ—Ç—å –≤ –ª—é–¥—è—Ö —Ç–æ–ª—å–∫–æ –ª—É—á—à–µ–µ."
]

# –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–Ω–æ–ø–∫–æ–π
def get_main_keyboard():
    markup = telebot.types.ReplyKeyboardMarkup(resize_keyboard=True)
    btn = telebot.types.KeyboardButton("‚ú® –ü–æ–ª—É—á–∏—Ç—å –ø–æ–∂–µ–ª–∞–Ω–∏–µ")
    markup.add(btn)
    return markup

@bot.message_handler(commands=['start'])
def cmd_start(message):
    # –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –∫–∞—Ä—Ç–∏–Ω–∫—É –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ, —É–∫–∞–∂–∏ –ø—É—Ç—å –∏–ª–∏ —Å—Å—ã–ª–∫—É –∑–¥–µ—Å—å
    # bot.send_photo(message.chat.id, "–°–°–´–õ–ö–ê_–ù–ê_–§–û–¢–û") 
    bot.send_message(
        message.chat.id, 
        f"–ü—Ä–∏–≤–µ—Ç, {message.from_user.first_name}! –¢—ã –Ω–∞ –≥–ª–∞–≤–Ω–æ–π –ø–ª–æ—â–∞–¥–∏ –ê–∫–∞–¥–µ–º–∏–∏ –ê—Ä–∫–∞–Ω—ã... üéÜ\n"
        "–í–æ–∫—Ä—É–≥ —Ä–∞—Å—Å—ã–ø–∞—é—Ç—Å—è –∏—Å–∫—Ä—ã –°–∞–ª—é—Ç–∞ –°—É–¥–µ–±. –ù–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã –ø–æ–π–º–∞—Ç—å —Å–≤–æ—é!",
        reply_markup=get_main_keyboard()
    )

@bot.message_handler(func=lambda message: message.text == "‚ú® –ü–æ–ª—É—á–∏—Ç—å –ø–æ–∂–µ–ª–∞–Ω–∏–µ")
def send_wish(message):
    bot.send_chat_action(message.chat.id, action="typing")
    wish = random.choice(WISHES)
    
    # –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å –∫–∞—Ä—Ç–∏–Ω–∫–æ–π, –µ—Å–ª–∏ —Ñ–∞–π–ª magic.jpg –µ—Å—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
    try:
        if os.path.exists("magic.jpg"):
            with open("magic.jpg", "rb") as photo:
                bot.send_photo(
                    message.chat.id, 
                    photo, 
                    caption=f"üéá **–°–∞–ª—é—Ç —Å—É–¥–µ–± –≥–ª–∞—Å–∏—Ç:**\n\n{wish}",
                    parse_mode="Markdown"
                )
        else:
            bot.send_message(message.chat.id, f"üéá **–°–∞–ª—é—Ç —Å—É–¥–µ–± –≥–ª–∞—Å–∏—Ç:**\n\n{wish}", parse_mode="Markdown")
    except Exception as e:
        bot.send_message(message.chat.id, f"üéá **–°–∞–ª—é—Ç —Å—É–¥–µ–± –≥–ª–∞—Å–∏—Ç:**\n\n{wish}", parse_mode="Markdown")

if __name__ == "__main__":
    keep_alive() # –î–ª—è Render
    print("–ë–æ—Ç –æ–∂–∏–ª!")
    bot.infinity_polling()

